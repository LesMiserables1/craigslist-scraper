<!DOCTYPE html5>
<html>

<head>
  <meta charset='utf-8'>
  <meta http-equiv='X-UA-Compatible' content='IE=edge'>
  <title>Bot Project</title>
  <meta name='viewport' content='width=device-width, initial-scale=1'>

  <link rel='stylesheet' type='text/css' media='screen' href='css/bootsrap/css/bootstrap.min.css'>

  <!--Bootstrap references-->
  <script src="js/bootsrap/js/jquery-3.5.1.slim.min.js"></script>
  <script src="js/bootsrap/js/bootstrap.bundle.min.js"></script>
  <script src="js/bootsrap/js/bootstrap.bundle.js"></script>
  <script src="js/bootsrap/js/bootstrap.js"></script>

  <!--JQuery references-->
  <script src="js/jquery-3.5.1.min.js"></script>

  <link rel='stylesheet' type='text/css' media='screen' href='css/main.css'>

</head>
<script>
  var demoArray = ['sell', 'buy', '2342342442', 'jesus1', 'america'
    , 'sell', 'buy', '2342342442', 'jesus2', 'america'
    , 'sell', 'buy', '2342342442', 'jesus3', 'america'
    , 'sell', 'buy', '2342342442', 'jesus4', 'america'
    , 'sell', 'buy', '2342342442', 'jesus5', 'america'
    , 'sell', 'buy', '2342342442', 'jesus6', 'america'
    , 'sell', 'buy', '2342342442', 'jesus7', 'america'
    , 'sell', 'buy', '2342342442', 'jesus8', 'america'
    , 'sell', 'buy', '2342342442', 'jesus9', 'america'
    , 'sell', 'buy', '2342342442', 'jesus10', 'america'
    , 'sell', 'buy', '2342342442', 'jesus11', 'america'
    , 'sell', 'buy', '2342342442', 'jesus12', 'america'];

  function PrincipalData(a) {
    // console.log(dat);
    var info;
    var BeginPage = a - 5;
    var EndPage = a;

    $("#results").children().hide();
    for (let i = BeginPage; i < EndPage; i++) {
      $('#' + i + 'a').show();
      $('#' + i + 'b').show();
      $('#' + i + 'c').show();
      $('#' + i + 'd').show();
      $('#' + i + 'e').show();
      $('#' + i + 'f').show();


    }

  }
</script>

<body>
  <!--Nav bar-->
  <nav class="navbar navbar-expand-lg navbar-light bg-secondary navbar-custom">
    <a class="navbar-brand" href="#">Craigslist bot</a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav"
      aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarNav">
      <ul class="navbar-nav ml-auto">
        <li class="nav-item active">
          <a class="nav-link" href="#">About <span class="sr-only">(current)</span></a>
        </li>


        <li class="nav-item">
          <a class="nav-link disabled" href="#" tabindex="-1" aria-disabled="true">Disabled</a>
        </li>
      </ul>
    </div>
  </nav>
  <!--Nav bar-->
  <!--Principal-->
  <div class="container">
    <div class="card-body">
      <div class="row">
        <!--Left container-->
        <div class="col-lg-3 card">
          <p class="text-center font-weight-bold">Filters:</p>
          <p>Select place:</p>
          <div class="input-group mb-3">
            <select class="custom-select" id="location">
              <option selected>Choose...</option>
              <option value="1">boston</option>
              <option value="1">boston</option>
            </select>
          </div>
          
        </div>
        <!--End Left container-->

        <!--Right container-->
        <div class="col-lg-9">
          <div class="input-group  mb-3">
            <input id="keyword" type="text" class="form-control" placeholder="Key word"
              aria-label="Recipient's username" aria-describedby="basic-addon2">
            <div class="input-group-append">
              <button id="process" class="btn btn-outline-secondary" type="button">Search</button>
            </div>
          </div>
          <hr>
          <!--Alerts-->
          <div id="alertscraping" class="alert alert-warning collapse" role="alert">
            Data is been scraping...
          </div>
          <div id="alertdone" class="alert alert-success collapse" role="alert">
            Data is ready.
          </div>
          <div id="alerterror" class="alert alert-danger collapse" role="alert">
            Something was wrong.
          </div>
          <div id="alertresults" class="alert alert-danger collapse" role="alert">
            <h4 class="text-center">Not data found! </h4>
           </div>
          <!--End Alerts-->
          <div id="results">
          </div>
        </div>
        <!--End Right container-->
      </div>
    </div>
  </div>
  <!--End principal-->
  <!--Pagination-->
  <div class="card-body ">
    <nav aria-label="Page navigation example">
      <ul id="PaginationPrincipal" class="pagination justify-content-center">
      </ul>
    </nav>
  </div>
  </div>

  <!--End Pagination-->
  <hr>
  <footer class="container-fluid text-center">

    <h1>FOOTER</h1>
  </footer>

</body>
<script>
  $(document).ready(function () {

    //=============================Event when click the Search bottom
    $("#process").click(function () {
      $('#alertscraping').show();
      $('#alertresults').hide();
      $("#process").attr("disabled", true);


      $.ajax({
        //url: 'Json.json',
        type: 'POST',
        url: 'http://localhost:3000/scrape',
        data: JSON.stringify({ location: $('#location option:selected').text(), query: $('#keyword').val() }),
        dataType: "JSON",
        contentType: "application/json",

        success: function (data) {
          $("#alertscraping").hide();
          $("#process").attr("disabled", false);


         

          var dat = JSON.parse(JSON.stringify(data));
          if (dat.data.length != 0) {
            $('#alertdone').fadeIn(1000);
          setTimeout(function () {
            $('#alertdone').fadeOut(1000);
          }, 3000);

            $("#results").empty();
            for (let i = 0; i < dat.data.length; i++) {
              var f = dat.data[i];
              $("#results").append("<p id='" + i + "a' class ='text-center' style='font-size: 25px;display:none;' ><strong>Post </strong>" + (i + 1) + "</p>");
              $("#results").append("<p id='" + i + "b' style='display:none;'><strong>Title: </strong>" + f[1].title + "</p>");
              $("#results").append("<p id='" + i + "c' style='display:none;'><strong>ID: </strong>" + f[4].post_id + "</p>");
              $("#results").append("<p id='" + i + "d' style='display:none;'><strong>Email: </strong>" + f[0].email + "</p>");
              $("#results").append("<p id='" + i + "e' style='display:none;'><strong>Address: </strong>" + f[2].address + "</p>");
              $("#results").append("<p style= 'width: 100%; display:none;' id='" + i + "f'><strong>Desc: </strong>" + f[3].desc + "</p>");
            }

            //=======================================Create the pagination part
            var a = 0;
            $("#PaginationPrincipal").empty();
            for (let i = 0; i < dat.data.length / 5; i++) {
              var f = dat.data[i];
              a = a + 5;

              $("#PaginationPrincipal").append("<li class='page-item'><a class='page-link' href='javascript:PrincipalData(" + a + ")'>" + (i + 1) + "</a></li>");
            }
            //========================================End of pagination function
            PrincipalData("5");
          } else {
            console.log(data);
            $('#alertresults').show();

          }

        },
        error: function () {
          $("#alertscraping").hide();

          $('#alerterror').fadeIn(1000);
          setTimeout(function () {
            $('#alerterror').fadeOut(1000);
          }, 3000);

        }
      });

    });
    //===============================End event when click the Search bottom

    

    //===============================Event when dropdown change
    /*$("#location").change(function () {
      $.ajax({
        type: 'POST',
        url: 'Json.json',
        // url: 'http://localhost:3000/content',
        // contentType : "application/json",
        // data: JSON.stringify({ location: $('#location option:selected').text(), query: $('#keyword').val() }),
        // dataType: "JSON",
        success: function (data) {
          var dat = JSON.parse(JSON.stringify(data));
          console.log(dat.data.length);
          console.log(data);
        },
        error: function () {
          alert("Ooops! Something was wrong!");
        }
      });
    });*/
    //===============================End event when dropdown change
  });



</script>

</html>